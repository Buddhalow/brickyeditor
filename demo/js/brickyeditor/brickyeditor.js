var BrickyEditor=function(e){"use strict";var m=function(){return(m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function v(l,o,a,c){return new(a=a||Promise)(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,r)}i((c=c.apply(l,o||[])).next())})}function h(n,r){var i,l,o,e,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,l&&(o=2&t[0]?l.return:t[0]?l.throw||((o=l.return)&&o.call(l),0):l.next)&&!(o=o.call(l,t[1])).done)return o;switch(l=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,l=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){a.label=t[1];break}if(6===t[0]&&a.label<o[1]){a.label=o[1],o=t;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(t);break}o[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(n,a)}catch(e){t=[6,e],l=0}finally{i=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function b(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var l=arguments[t],o=0,a=l.length;o<a;o++,i++)r[i]=l[o];return r}function n(e){var t=e.tag,n=void 0===t?"div":t,r=e.className,i=e.innerHTML,l=e.props,o=document.createElement(n);return void 0!==r&&(Array.isArray(r)?r.forEach(function(e){return o.classList.add(e)}):o.className=r),void 0!==i&&(o.innerHTML=i),void 0!==l&&Object.assign(o,l),o}function g(r){return new Promise(function(e,n){var t=new XMLHttpRequest;t.open("GET",r,!0),t.onreadystatechange=function(){if(4===this.readyState)if(200<=this.status&&this.status<400){var t=null;try{t=JSON.parse(this.responseText)}catch(e){t=this.responseText}try{e(t)}catch(e){n(e)}}else n()},t.send(),t=null})}function c(e,t){return e.type===t}function u(e,t){var n=e.data;Object.keys(t).some(function(e){return n[e]!==t[e]})&&(e.data=m(m({},n),{changes:t}))}function i(e,t){k.toggleClassName(e.$element,"bre-field-selected",t),t?e.parentBlock.parentContainer.editor.fire("fieldSelect",{sender:e}):e.parentBlock.parentContainer.editor.fire("fieldBlur",{sender:e})}function l(e){var t=e.cloneNode(!0);return t.attributes.removeNamedItem(s),t}var r="bre-hidden",o=function(e,t,n){return e.classList.toggle(t,n)},a=function(e,t){return e&&t?e.toLowerCase()===t.toLowerCase():e===t},k={createElement:function(e,t){var n=document.createElement("div");n.innerHTML=e;var r=n.children[0];return n.innerHTML="",void 0!==t&&(r.className=t),r},div:function(e,t){return n({className:e,innerHTML:t})},el:n,parseElementData:function(e,t){var n=e.dataset[t];if(void 0===n)return null;var r=null;try{r=JSON.parse(n)}catch(e){if(e instanceof SyntaxError){n=n.replace(/'/g,'"');try{if(void 0===(r=JSON.parse(n)).name||void 0===r.type)return null}catch(e){return null}}}return r},toggleVisibility:function(e,t){void 0===t&&(t=e.classList.contains(r)),o(e,r,!t)},toggleClassName:o,readFileAsync:function(r){return v(void 0,void 0,void 0,function(){return h(this,function(e){return[2,new Promise(function(n,t){var e=new FileReader;e.onload=function(e){if(null!==e.target&&null!==e.target.result){var t=e.target.result.toString();n(t)}};try{e.readAsDataURL(r)}catch(e){t(e)}})]})})},objectToArray:function(t){return Object.keys(t).map(function(e){return e[t]})},filterNotNull:function(e){return e.filter(function(e){return null!==e})},convertNodeListToArray:function(e){return Array.prototype.slice.call(e)},msg:function(e,t){window.BrickyEditor.i18n.default="en",window.BrickyEditor.i18n.locale="en";var n=(window.BrickyEditor.i18n.messages[window.BrickyEditor.i18n.locale]||window.BrickyEditor.i18n.messages[window.BrickyEditor.i18n.default])[e];return void 0===n?"":(void 0!==t&&Object.keys(t).forEach(function(e){n.replace(/`{${p}}`/g,t[e])}),n)}},d=function(l){return new Promise(function(t,n){function e(){var e=r.readyState;!1!==i||void 0!==e&&"loaded"!==e&&"complete"!==e?n():(i=!0,t())}var r=document.createElement("script"),i=!1;r.onload=e,void 0!==r.onreadystatechange&&(r.onreadystatechange=e),r.src=0===l.indexOf("//")?"https:"+l:l,document.head.appendChild(r)})},s="data-bre-field",p=function(e){var t=e.container,n=ie(t);return k.createElement(n)},f=function(e){var t=e.parentBlock.parentContainer.editor.state;if(t.selectedField!==e){var n=t.selectedField;null!==n&&i(n,!1),"container"===e.data.type?(y(e.parentBlock,!1),E(e.container)):y(e.parentBlock),t.selectedField=e,i(e,!0)}},y=function(e,t){void 0===t&&(t=!0);var n=e.parentContainer.editor.state;if(n.selectedBlocks[0]!==e){n.selectedField=null;var r=n.selectedBlocks,i=w(e);n.selectedBlocks=i,0<r.length&&r.forEach(function(e){ne(e,!1)}),i.forEach(function(e,t){e.selected||ne(e,!0,0===t)}),t&&E(e.parentContainer)}},w=function(e,t){void 0===t&&(t=[]),t.push(e);var n=e.parentContainer.parentContainerField;return null!==n?w(n.parentBlock,t):t},E=function(e){var t=e.editor.state,n=$(e);t.selectedContainers=n},$=function(e){return null===e.parentContainerField?[e]:b([e],w(e.parentContainerField.parentBlock).map(function(e){return e.parentContainer}))};function C(e){var t=l(e.$element);return t.removeAttribute("contenteditable"),t}function B(e,t,n){function r(){l.remove(),function(e){if(null!==e&&0!==e.length){var t=window.getSelection();null!==t&&(t.removeAllRanges(),e.forEach(function(e){return t.addRange(e)}))}}(i)}var i=function(){var e=window.getSelection();if(null===e)return null;for(var t=[],n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t}(),l=k.div("bre-modal"),o=k.el({tag:"button",props:{type:"button",onclick:function(){t&&t(),r()},innerHTML:"Ok"}}),a=k.el({tag:"button",props:{type:"button",onclick:function(){n&&n(),r()},innerHTML:"Cancel"}}),c=k.div("bre-modal-placeholder");c.append(e,o,a),l.append(c),document.body.appendChild(l)}function x(l){return new Promise(function(e){var t=l.editor;if(void 0!==t){var n=t(l),r=n.$element,i=n.data;B(r,function(){e(i)},function(){e(null)})}else e(null)})}function N(e,t,n){var r=n.title;if(void 0!==r){var i=k.el({tag:"label",className:"bre-field-editor-label",innerHTML:r,props:{onclick:function(){return t.focus()}}});e.append(i)}}function L(i){var e=i.type,t=i.placeholder,n=k.div("bre-field-editor-prop"),l=k.el({tag:"input",className:"bre-field-editor-input",props:{type:e,placeholder:t||""}});if("text"===i.type){var r=function(){i.onUpdate(l.value)};l.value=i.value||"",l.onchange=r,l.onkeyup=r,l.onpaste=r}else i.type="file",l.onchange=function(){return v(void 0,void 0,void 0,function(){var t,n,r;return h(this,function(e){switch(e.label){case 0:return t=l.files,null===(n=null===t?null:t[0])?[3,2]:[4,k.readFileAsync(n)];case 1:r=e.sent(),i.onUpdate(n,r),e.label=2;case 2:return[2]}})})};return N(n,l,i),n.append(l),n}var T=function(e){return e.replace("https://www.instagram.com","http://instagr.am")},M=function(e){switch(e){case"Instagram":var t=window.instgrm;void 0!==t&&t.Embeds.process()}},F=function(e){var l="https://noembed.com/embed?url="+e;return new Promise(function(r,i){return v(void 0,void 0,void 0,function(){var t,n;return h(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(o=l,new Promise(function(n,e){var r="_"+Math.round(1e4*Math.random()),i="jsonp_callback_"+r;window[i]=function(e){delete window[i];var t=document.getElementById(r);null!==t&&t.remove(),n(e)};var t=o+"&callback="+i,l=document.createElement("script");l.src=t,l.id=r,l.addEventListener("error",e),(document.getElementsByTagName("head")[0]||document.body||document.documentElement).appendChild(l)}))];case 1:return t=e.sent(),r(t),[3,3];case 2:return n=e.sent(),i(n),[3,3];case 3:return[2]}var o})})})},H={},O=function(){return k.div(["bre-field-placeholder","bre-icon","bre-icon-32"],'<svg viewBox="0 0 512 512">\n  <path d="M160 368L32 256l128-112M352 368l128-112-128-112M304 96l-96 320"/>\n</svg><span>embed</span>')};function A(e){return l(e.$element)}function S(e){var t=m({},e.data),n=k.div("bre-field-editor-root"),r=k.div("bre-field-editor-preview");P(r,t);var i=L({title:k.msg("embed.link.title"),placeholder:k.msg("embed.link.placeholder"),value:t.url||"",type:"text",onUpdate:function(e){t.url!=e&&(t.url=e,P(r,t))}});return n.append(r,i),{$element:n,data:t}}function P(i,e){var l=e.url;return v(this,void 0,void 0,function(){var t,n,r;return h(this,function(e){switch(e.label){case 0:return void 0===l?(i.appendChild(O()),[2]):[4,F(T(l))];case 1:return t=e.sent(),n=k.div(void 0,t.html),null!==(r=n.querySelector("script"))&&r.remove(),i.innerHTML=n.innerHTML,null===r?[3,4]:void 0!==H[r.src]?[3,3]:[4,d(r.src)];case 2:e.sent(),H[t.provider_name]=!0,e.label=3;case 3:setTimeout(function(){return M(t.provider_name)},100),e.label=4;case 4:return[2]}})})}function U(e){var t,n,r,i,l,o,a,c=e?m({},e):{},u=k.div("bre-field-editor-root"),d=L({title:k.msg("link.url.title"),placeholder:k.msg("link.url.placeholder"),value:c.href,type:"text",onUpdate:function(e){return c.href=e}}),s=L({title:k.msg("link.title.title"),placeholder:k.msg("link.title.placeholder"),value:c.title,type:"text",onUpdate:function(e){return c.title=e}}),p=(t={title:k.msg("link.target.title"),value:c.target,options:[{value:""},{value:"_blank"},{value:"_self"},{value:"_parent"},{value:"_top"}],onUpdate:function(e){return c.target=e}},n=t.placeholder,r=t.value,i=t.options,l=t.onUpdate,o=k.div("bre-field-editor-prop"),(a=k.el({tag:"select",className:"bre-field-editor-input",props:{placeholder:n||""}})).onchange=function(){return l(a.value)},a.innerHTML=i.map(function(e){return'<option value="'+e.value+'" '+(e.value===r?"selected":"")+">"+(e.label||e.value)+"</option>"}).join("\n"),N(o,a,t),o.append(a),o);return u.append(d,s,p),{$element:u,data:c}}function D(e,t){var n=I(t),r=t.alt||"";if("img"===e.tagName.toLowerCase()){var i=e;i.src=n,i.alt=r}else e.style.backgroundImage="url("+n+")";e.title=r}function j(e){var t=this,n=e.data,i=m({},n),r=k.div("bre-field-editor-root"),l=k.el({tag:"img",className:"bre-field-editor-preview-img",props:{src:I(i)}}),o=k.div("bre-field-editor-preview");o.appendChild(l);var a=L({title:k.msg("image.link.title"),placeholder:k.msg("image.link.placeholder"),value:i.src,type:"text",onUpdate:function(e){l.src=e,i.src=e,i.file=void 0}}),c=L({title:k.msg("image.upload.title"),placeholder:k.msg("image.upload.title"),type:"file",value:i.file?i.file.fileContent:"",onUpdate:function(n,r){return v(t,void 0,void 0,function(){var t;return h(this,function(e){return l.src=r,t={name:n.name,size:n.size,type:n.type,lastModified:n.lastModified},i.src=void 0,i.file={fileContent:r,fileInfo:t},[2]})})}}),u=L({title:k.msg("image.alt.title"),placeholder:k.msg("image.alt.title"),value:i.alt,type:"text",onUpdate:function(e){return i.alt=l.alt=e}}),d=U(n.link),s=d.$element,p=d.data;return i.link=p,r.append(o,a,c,u,s),{$element:r,data:i}}function q(e){var t=e.$element,n=e.data.link,r=l(t);if(void 0!==n&&void 0!==n.href&&n.href.length){var i=k.el({tag:"a",props:n});return i.appendChild(r),i}return r}function I(e){return e.src||(void 0!==e.file?e.file.fileContent:"")}function _(e){var t=e.$element,n=e.data,r=k.parseElementData(t,"breField");if(null===r)return null;void 0!==n&&(r=m(m({},r),n));var i,l=(i=r.type,V[i]);if(void 0===l)throw new Error(r.type+" field not found");return l(e)}function R(e,l){var t=G(e).map(function(e){var t,n,r,i=(t=e,n=l,null!==(r=k.parseElementData(t,"breField"))?(r=function(e,t){if(!e.data||!e.data.fields)return null;var n=e.data.fields.find(function(e){return a(e.name,t)});return void 0!==n?n:null}(n,r.name)||r,_({parentBlock:n,$element:t,preview:!1,data:r})):null);return null!==i&&i.parentBlock.parentContainer.editor.fire("fieldCreate",{sender:i}),i});return k.filterNotNull(t)}function z(e){var t=G(e).map(function(e){return t=e,null!==(n=k.parseElementData(t,"breField"))?_({$element:t,data:n,preview:!0}):null;var t,n});return k.filterNotNull(t)}var V={html:function(e){var t,n,r,i=e.$element,l=e.data;if(!c(l,"html"))return null;if(e.preview)return i.innerHTML=50<(t=i).innerHTML.length?t.innerHTML.substr(0,50)+"...":t.innerHTML,{$element:i};n=i,void 0!==(r=l.html)&&(n.innerHTML=r);function o(){var e=i.innerHTML.trim();i.innerHTML!==e&&u(a,{html:e})}var a={parentBlock:e.parentBlock,$element:i,data:l,html:C};return i.setAttribute("contenteditable","true"),i.addEventListener("blur",o),i.addEventListener("keyup",o),i.addEventListener("paste",o),i.addEventListener("input",o),i.addEventListener("paste",function(e){if(e.preventDefault(),e.clipboardData){var t=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,t)}}),i.addEventListener("click",function(e){e.stopPropagation(),f(a)}),a},image:function(e){var t=e.$element,n=e.data;if(!c(n,"image"))return null;if(D(t,n),e.preview)return{$element:t};var r={$element:t,data:n,html:q,editor:j,parentBlock:e.parentBlock};return t.addEventListener("click",function(n){return v(void 0,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return n.stopPropagation(),f(r),[4,x(r)];case 1:return null!==(t=e.sent())&&(D(r.$element,t),u(r,t)),[2]}})})}),r},embed:function(e){var t=e.$element,n=e.data;if(!c(n,"embed"))return null;if(e.preview)return t.appendChild(O()),{$element:t};P(t,n);var r={$element:t,data:n,html:A,editor:S,parentBlock:e.parentBlock};return t.addEventListener("click",function(n){return v(void 0,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return n.stopPropagation(),f(r),[4,x(r)];case 1:return null!==(t=e.sent())&&(P(r.$element,t),u(r,t)),[2]}})})}),r},container:function(e){var t=e.$element,n=e.data;if(!c(n,"container"))return null;if(e.preview)return t.append(oe(!0)),{$element:t};t.addEventListener("click",function(e){e.stopPropagation(),f(r)});var r={$element:t,data:n,html:p,parentBlock:e.parentBlock},i=ce(r);return r.container=i,n.blocks&&0<n.blocks.length&&n.blocks.map(function(e){return ae(i,{blockData:e},!1)}),r}};function G(e){var t=e.querySelectorAll("[data-bre-field]"),n=0<t.length?Array.prototype.slice.call(t):[];return null!==e.attributes.getNamedItem(s)&&(n=b(n,[e])),n}function J(r){var n,e;return void 0===r.blockEditor&&(r.blockEditor=(n=k.div("bre-block-editor"),e=ee.map(function(e){var t=k.div(["bre-block-editor-button","bre-icon","bre-icon-light"],e.icon);return t.title=name,n.append(t),{$element:t,button:e}}),{$element:n,buttons:e}),r.blockEditor.buttons.forEach(function(e){var t=e.$element,n=e.button;t.onclick=function(e){e.stopPropagation(),void 0!==n.disabled&&n.disabled(r)||(n.action(r),te(r))}}),r.$element.prepend(r.blockEditor.$element)),te(r),r.blockEditor}function W(e,t){var n=function(t){var e=Q.find(function(e){return a(e.name,t)});if(void 0===e)throw new Error("Template is not registred: "+t);return e}(t.template),r=n.name,i=n.$template;return re(e,r,i,t)}function X(e){null===e.$placeholder&&(e.$placeholder=oe(!1)),0===e.$element.childElementCount?e.$element.appendChild(e.$placeholder):e.$placeholder.remove()}function K(o,e){var a=k.div("bre-templates-group"),t=k.div("bre-templates-group-name",e.name||"");return t.onclick=function(){for(var e=1;e<a.children.length;e++)k.toggleVisibility(a.children[e])},a.append(t),e.templates.forEach(function(t){var e,n,r,i,l=(e=t,n=o.options.templateSelector.zoom,r=k.div("bre-templates-group-item"),(i=e.$preview).setAttribute("title",e.name),n&&k.toggleClassName(i,"bre-template-zoom",!0),r.append(i),r);a.append(l),l.onclick=function(e){e.stopPropagation(),me(o,t)}}),a}function t(e,t){he(e,t)}var Q=[],Y=function(e){var t=e.querySelectorAll(".bre-template"),n=k.convertNodeListToArray(t).map(Z);return k.filterNotNull(n)},Z=function(e){var t=e.dataset.name||"",n=e.querySelector(".bre-template-preview");return null!==n?n.remove():(n=e.cloneNode(!0),z(n)),{name:t,$template:e,$preview:n}},ee=[{name:"delete",icon:'<svg viewBox="0 0 512 512">\n  <path d="M112 112l20 320c.95 18.49 14.4 32 32 32h184c17.67 0 30.87-13.51 32-32l20-320"/>\n  <path stroke-miterlimit="10" d="M80 112h352"/>\n  <path d="M192 112V72h0a23.93 23.93 0 0124-24h80a23.93 23.93 0 0124 24h0v40M256 176v224M184 176l8 224M328 176l-8 224"/>\n</svg>',action:function(e){return de(e)}},{name:"clone",icon:'<svg viewBox="0 0 512 512">\n  <rect width="336" height="336" x="128" y="128" rx="57" ry="57"/>\n  <path d="M383.5 128l.5-24a56.16 56.16 0 00-56-56H112a64.19 64.19 0 00-64 64v216a56.16 56.16 0 0056 56h24"/>\n</svg>',action:function(e){return se(e)}},{name:"up",icon:'<svg viewBox="0 0 512 512">\n  <path stroke-width="48" d="M112 328l144-144 144 144"/>\n</svg>',action:function(e){return pe(e,-1)},disabled:function(e){return 0===e.parentContainer.blocks.indexOf(e)}},{name:"down",icon:'<svg viewBox="0 0 512 512">\n  <path stroke-width="48" d="M112 184l144 144 144-144"/>\n</svg>',action:function(e){return pe(e,1)},disabled:function(e){return e.parentContainer.blocks.indexOf(e)===e.parentContainer.blocks.length-1}}],te=function(i){i.blockEditor&&i.blockEditor.buttons.forEach(function(e){var t=e.$element,n=e.button;if(void 0!==n.disabled){var r=n.disabled(i);k.toggleClassName(t,"bre-block-editor-button-disabled",r)}})},ne=function(e,t,n){var r,i,l;void 0===n&&(n=!1),e.selected=t,k.toggleClassName(e.$element,"bre-block-selected",t),t?(i=n,l=J(e),k.toggleVisibility(l.$element,!0),k.toggleClassName(l.$element,"bre-block-editor-vertical",!i)):void 0!==(r=e.blockEditor)&&(k.toggleVisibility(r.$element,!1),k.toggleClassName(r.$element,"bre-block-editor-vertical",!1))},re=function(e,t,n,r){void 0===r&&(r={template:t,fields:[]});var i=n.cloneNode(!0);k.toggleClassName(i,"bre-template",!1),k.toggleClassName(i,"bre-template-zoom",!1),k.toggleClassName(i,"bre-block",!0);var l={parentContainer:e,$element:i,data:r,selected:!1};return l.fields=R(i,l),l},ie=function(e){var t=e.blocks.map(function(e){return""}).join("\n"),n=e.$element.cloneNode(!1);return n.innerHTML=t,n.outerHTML},le=k.div(["bre-field-placeholder","bre-container-placeholder","bre-icon","bre-icon-32"],'<svg viewBox="0 0 512 512">\n  <rect width="80" height="80" x="64" y="64" rx="40" ry="40"/>\n  <rect width="80" height="80" x="216" y="64" rx="40" ry="40"/>\n  <rect width="80" height="80" x="368" y="64" rx="40" ry="40"/>\n  <rect width="80" height="80" x="64" y="216" rx="40" ry="40"/>\n  <rect width="80" height="80" x="216" y="216" rx="40" ry="40"/>\n  <rect width="80" height="80" x="368" y="216" rx="40" ry="40"/>\n  <rect width="80" height="80" x="64" y="368" rx="40" ry="40"/>\n  <rect width="80" height="80" x="216" y="368" rx="40" ry="40"/>\n  <rect width="80" height="80" x="368" y="368" rx="40" ry="40"/>\n</svg>'),oe=function(e){var t=le.cloneNode(!0);return e&&k.toggleClassName(t,"bre-container-placeholder",!1),t},ae=function(e,t,n){var r=e.blocks,i=e.selectedBlock,l=void 0!==t.blockData?W(e,t.blockData):re(e,t.blockTemplate.name,t.blockTemplate.$template),o=t.idx;void 0===o&&(o=null!==i?r.indexOf(i)+1:r.length),e.blocks=b(r.slice(0,o),[l],r.slice(o)),X(e);var a=e.$element,c=l.$element;0===o?a.append(c):r[o-1].$element.after(c);return n&&y(l),e.editor.fire("blockAdd",{sender:l}),l},ce=function(e){return ue(e.parentBlock.parentContainer.editor,e)},ue=function(e,t){void 0===t&&(t=null);var n={editor:e,$element:null!==t?t.$element:e.$element,blocks:[],$placeholder:null,selectedBlock:null,parentContainerField:t};return X(n),n},de=function(t){var e,n=t.parentContainer,r=n.blocks.indexOf(t);n.blocks=n.blocks.filter(function(e){return e!==t}),t.$element.remove(),0===n.blocks.length?(X(n),null!==n.parentContainerField?f(n.parentContainerField):(null!==(e=n.editor.state).selectedField&&i(e.selectedField,!1),e.selectedBlocks.forEach(function(e){return ne(e,!1)}),e.selectedField=null,e.selectedBlocks=[],e.selectedContainers=[e.selectedContainers[0]])):n.blocks.length>r?y(n.blocks[r]):y(n.blocks[r-1]),t=null},se=function(e){var t=e.parentContainer,n=t.blocks.indexOf(e)+1;ae(t,{idx:n,blockData:e.data},!0)},pe=function(e,t){var n=e.$element,r=e.parentContainer;if(null!==n.parentElement){var i=r.blocks.indexOf(e),l=i+t;if(!(l>=r.blocks.length||l<0)){var o=r.blocks[l].$element;o&&(0<t?n.parentElement.insertBefore(o,n):t<0&&n.parentElement.insertBefore(n,o)),r.blocks.splice(i,1),r.blocks.splice(l,0,e)}}},fe={locale:"en",templatesUrl:"templates/bootstrap4.html",compactTools:!1,compactToolsWidth:768,ignoreHtml:!0,templateSelector:{zoom:!0}},me=function(e,t){var n=e.state,r=n.selectedContainers[0],i=0<n.selectedBlocks.length?n.selectedBlocks[0]:null,l=null!==i?r.blocks.indexOf(i)+1:r.blocks.length;null!==r&&ae(r,{blockTemplate:t,idx:l},!0)},ve={"embed.link.title":"Link to embed media","embed.link.placeholder":"Link to instagram, youtube and etc.","image.link.title":"Image link","image.link.placeholder":"http://url-to-image.png","image.upload.title":"or Upload a file","image.upload.placeholder":"select file","image.upload.button":"Select file","image.alt.title":"Alt","image.alt.placeholder":"Image 'alt' attribute value","image.url.subtitle":"Link to open on image click","link.url.title":"Url","link.url.placeholder":"http://put-your-link.here","link.title.title":"Title","link.title.placeholder":"Title attribute for link","link.target.title":"Target","button.close":"close","button.ok":"Ok","button.cancel":"Cancel","templates.group.name.default":"Other templates","error.blocksFileNotFound":"Blocks file not found. Requested file: {url}.","error.templatesFileNotFound":"Templates file not found. Requested file: {url}.","error.blockTemplateNotFound":"Template '{templateName}' not found.","error.templateParsing":"Template parsing error: {name}."},he=function(p,f){return new Promise(function(s){return v(void 0,void 0,void 0,function(){var t,n,r,l,o,a,d;return h(this,function(e){switch(e.label){case 0:return window.BrickyEditor=window.BrickyEditor||{},window.BrickyEditor.i18n=window.BrickyEditor.i18n||{},window.BrickyEditor.i18n.messages=window.BrickyEditor.i18n.messages||{},window.BrickyEditor.i18n.messages.en=ve,window.BrickyEditor.i18n.locale="en",window.BrickyEditor.i18n.default="en",t=m(m({},fe),f),i={},n={selectedField:null,selectedBlocks:[],selectedContainers:[]},r=m(m({},{fire:function(e,t){var n=i[e];void 0!==n&&n.forEach(function(e){return e(t)})},on:function(e,t){void 0===i[e]&&(i[e]=[]);var n=i[e];-1===n.indexOf(t)&&n.push(t)},off:function(e,t){var n=i[e];if(void 0!==n){var r=n.indexOf(t);-1<r&&n.splice(r,1)}}}),{$element:p,data:function(){return be()},html:function(){return ge()},state:n,options:t,shared:{modal:B,helpers:k}}),l=ue(r),r.state.selectedContainers=[l],t.plugins&&t.plugins.map(function(e){return e.plugin.init(r)}),k.toggleClassName(p,"bre-editor",!0),[4,(c=t.templatesUrl,u=r.$element,v(void 0,void 0,void 0,function(){var r,t,n,i,l,o,a;return h(this,function(e){switch(e.label){case 0:r=[],e.label=1;case 1:return e.trys.push([1,3,,4]),[4,g(c)];case 2:return t=e.sent(),n=k.createElement("<div>"+t+"</div>"),null!==(i=n.querySelector("style"))&&null!==u.parentElement&&null!==(a=u.parentElement)&&void 0!==a&&a.insertBefore(i,u),n.querySelectorAll(".bre-template-group").forEach(function(e){var t=e.getAttribute("title"),n=Y(e);r.push({name:t,templates:n}),e.remove(),Q=b(Q,n)}),l=Y(n),o=0<r.length?k.msg("templates.group.name.default"):"",r.push({name:o,templates:l}),Q=b(Q,l),[2,r];case 3:throw e.sent();case 4:return[2]}})}))];case 1:return o=e.sent(),a=function(n){var e=k.div("bre-templates-root"),t=k.div("bre-templates-loader","...LOADING..."),r=k.div("bre-templates-list");e.append(t,r);return{$element:e,setTemplates:function(e){k.toggleVisibility(t,!1),e.forEach(function(e){if(0!==e.templates.length){var t=K(n,e);r.append(t)}})}}}(r),void 0!==o&&(a.setTemplates(o),p.append(a.$element)),[4,ke(t)];case 2:return null!==(d=e.sent())&&d.map(function(e){return ae(l,{blockData:e},!1)}),s(r),[2]}var c,u,i})})})},be=function(e){throw Error("not implemented")},ge=function(e){throw Error("not implemented")},ke=function(e){var o=e.blocks,a=e.blocksUrl;return new Promise(function(i,l){return v(void 0,void 0,void 0,function(){var t,n,r;return h(this,function(e){switch(e.label){case 0:if(void 0===(t=a))return[3,5];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,g(t)];case 2:return n=e.sent(),i(n),[3,4];case 3:return r=e.sent(),l(r),[3,4];case 4:return[2];case 5:return void 0!==o?(i(o),[2]):(i(null),[2])}})})})};return e.Editor=t,e.editor=he,e}({});
