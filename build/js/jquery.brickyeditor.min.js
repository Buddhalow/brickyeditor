var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),BrickyEditor;!function(t){var e=function(){function e(e,o,n,i){this.fields=[];this.editor=e,this.container=o,this.template=n;var r=t.TemplateService.getTemplate(n);this.$block=$(r.html);var a=this.getBlockTools(this.$block);this.$editor=a,a.hover(function(){a.addClass("active")},function(){a.removeClass("active")}),this.bindBlockFields(i)}return e.prototype.getBlockTools=function(t){var e=this,n=$("<div class='brickyeditor-block-wrapper'>\n                    <div  class='brickyeditor-block-tools'>\n                        <a class='fa fa-trash-o' data-brickyeditor-block-action='"+o.Delete+"'></a>\n                        <a class='fa fa-copy' data-brickyeditor-block-action='"+o.Copy+"'></a>\n                        <a class='fa fa-angle-up' data-brickyeditor-block-action='"+o.Up+"'></a>\n                        <a class='fa fa-angle-down' data-brickyeditor-block-action='"+o.Down+"'></a>\n                    </div>\n                </div>");return $("[data-brickyeditor-block-action]",n).on("click",function(){var t=$(this).attr("data-brickyeditor-block-action");e.action(parseInt(t))}),n.append(t),n},e.prototype.action=function(t){switch(t){case o.Delete:this.container.deleteBlock(this);break;case o.Up:this.container.moveBlock(this,-1);break;case o.Down:this.container.moveBlock(this,1);break;case o.Copy:this.container.copyBlock(this)}},e.prototype.bindBlockFields=function(e){var o=this;this.$block.find(t.Constants.selectorField).addBack(t.Constants.selectorField).each(function(){var n,i=$(this),r=t.TemplateService.getFieldValue(i,"name");e&&e.forEach(function(t){t.name===r&&(n=t.data)});var a=t.Fields.BaseField.getField(o,i,n);a&&o.fields.push(a)})},e.prototype.getData=function(){var t=[];return this.fields.forEach(function(e){t.push(e.getData())}),{template:this.template,html:this.getHtml(!0),fields:t}},e.prototype.getHtml=function(e,o){void 0===o&&(o=!1);var n=this.$block.clone();n.find(t.Constants.selectorField).addBack(t.Constants.selectorField).each(function(e,n){if(!o){var i=t.Common.propsFilterKeys(n.attributes,function(e,o){return o.name.breStartsWith(t.Constants.field)}).map(function(t){return n.attributes[t].name});i.push("contenteditable"),i.forEach(function(t){n.removeAttribute(t)})}});var i=n[0].outerHTML;return e?i.breTotalTrim():i},e.prototype.selectBlock=function(t,e){this.container.selectedBlock.deselectBlock(),this.container.selectedBlock=this,this.container.selectedContainer=e},e.prototype.deselectBlock=function(){this.container.selectedContainer=null},e}();t.Block=e;var o;!function(t){t[t.Delete=0]="Delete",t[t.Settings=1]="Settings",t[t.Copy=2]="Copy",t[t.Up=3]="Up",t[t.Down=4]="Down"}(o||(o={}))}(BrickyEditor||(BrickyEditor={})),String.prototype.breContains=function(t){return this.indexOf(t)>=0},String.prototype.breStartsWith=function(t){return 0==this.indexOf(t)},String.prototype.breTotalTrim=function(){return this?this.replace(/\s\s+/g," ").trim():""},String.prototype.breEqualsInvariant=function(t){return this.toLowerCase()===t.toLowerCase()},Array.prototype.first=function(t){for(var e=0;e<this.length;e++){var o=this[e];if(t(this[e]))return o}return null};var BrickyEditor;!function(t){var e=function(){function t(){}return t.getSelectedText=function(){var t="",e=document;return window.getSelection?t=window.getSelection().toString():e.selection&&"Control"!=e.selection.type&&(t=e.selection.createRange().text),t},t.propsEach=function(t,e){for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];e(o,n)}},t.propsFilterKeys=function(e,o,n){var i=[];return t.propsEach(e,function(t,e){o(t,e)&&i.push(t)}),n&&i.push(n),i},t.arrayFilter=function(e,o,n){var i=[];return t.arrayEach(e,function(t){o(t)&&i.push(t)}),n&&i.push(n),i},t.arrayFind=function(e,o){return t.arrayEach(e,function(t){if(o(t))return t}),null},t.arrayFindByField=function(e,o,n){return t.arrayEach(e,function(t){if(t.hasOwnProperty(o)&&t[o]===n)return t}),null},t.arrayMap=function(e,o){var n=[];return t.arrayEach(e,function(t){n.push(o(t))}),n},t.arrayAny=function(t,e){for(var o=!1,n=0;n<t.length;n++){if(e(t[n])){o=!0;break}}return o},t.arrayEach=function(t,e){for(var o=0;o<t.length;o++){e(t[o])}},t}();t.Common=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function t(){}return t}();e.templatesFolder="templates/bootstrap4",e.field="data-bricky-field",e.templateModalKey="modal",e.templateToolsKey="tools",e.templateHtmlToolsKey="htmlTools",e.selectorModalContent=".brickyeditor-modal-content",e.selectorModalClose=".brickyeditor-modal-close",e.selectorTemplates=".templates",e.selectorTemplate=".template",e.selectorCancel=".brickyeditor-cancel",e.selectorSave=".brickyeditor-save",e.selectorLoader="#brickyeditorLoader",e.selectorFilter="#brickyeditorFilter",e.selectorField="["+e.field+"]",e.selectorHtmlToolsCommand="[data-brickyeditor-doc-command]",e.selectorHtmlToolsCommandRange="[data-brickyeditor-doc-command-range]",e.selectorBlockWrapper=".brickyeditor-block-wrapper",e.classMobile="brickyeditor-tools-mobile",e.dummyText="On the other hand, we denounce with righteous indignation and dislike men who are so beguiled and demoralized by the charms of pleasure of the moment, so blinded by desire, that they cannot foresee the pain and trouble that are bound to ensue.",t.Constants=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function e(e,o){this.blocks=[],this.$el=e,o?this.editor:this instanceof t.Editor&&(this.editor=this)}return Object.defineProperty(e.prototype,"selectedContainer",{get:function(){return this._selectedContainer},set:function(t){this._selectedContainer&&this._selectedContainer!=t&&this._selectedContainer.$el.removeClass("selected"),this._selectedContainer=t,this._selectedContainer&&this._selectedContainer.$el.addClass("selected")},enumerable:!0,configurable:!0}),e.prototype.getData=function(){var t=[];return this.blocks.forEach(function(e){t.push(e.getData())}),t},e.prototype.getHtml=function(){var t=[];return this.blocks.forEach(function(e){t.push(e.getHtml(!0))}),t.join("\n")},e.prototype.loadBlocks=function(t){var e=this;t&&t.length&&t.forEach(function(t){e.addBlock(t.template,t.fields)})},e.prototype.addBlock=function(e,o,n){var i=this;this.selectedBlock&&this.selectedContainer&&(i=this.selectedContainer);var r=new t.Block(this.editor,i,e,o);null==n&&null!=i.selectedBlock&&(n=i.blocks.indexOf(i.selectedBlock)+1),null!=n?(i.blocks[n-1].$editor.after(r.$editor),i.blocks.splice(n,0,r),i.selectedBlock=r):(i.$el.append(r.$editor),i.blocks.push(r)),i.selectedBlock=r,$("html, body").animate({scrollTop:r.$editor.offset().top},"fast")},e.prototype.deleteBlock=function(t){var e=this.blocks.indexOf(t);this.blocks.splice(e,1),t.$editor.remove(),t=null,this.selectedBlock=null},e.prototype.moveBlock=function(t,e){var o=this.blocks.indexOf(t),n=o+e;if(n<this.blocks.length&&n>=0){var i=this.blocks[n].$editor;e>0?i.after(t.$editor):e<0&&i.before(t.$editor),this.blocks.splice(o,1),this.blocks.splice(n,0,t)}},e.prototype.copyBlock=function(t){t.selectBlock();var e=this.blocks.indexOf(t)+1;this.addBlock(t.template,t.getData().fields,e)},e}();t.Container=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(e){function o(o,n){var i=e.call(this,o)||this;i.compactTools=null;var r=i;return i.options=new t.EditorOptions(n),i.loadTemplatesAsync().done(function(){r.loadBlocks(r.options.blocks),r.options.onload&&r.options.onload(r)}),i}return __extends(o,e),Object.defineProperty(o.prototype,"isMobile",{get:function(){return this._isMobile},set:function(e){this._isMobile!=e&&(this._isMobile=e,null!=this.$tools&&(this.$tools.toggle(!e),this.$toolsBtn.toggle(e),e?this.$tools.addClass(t.Constants.classMobile):this.$tools.removeClass(t.Constants.classMobile)))},enumerable:!0,configurable:!0}),o.prototype.loadTemplatesAsync=function(){var e=$.Deferred(),o=this,n=[];return n.push(t.TemplateService.loadTemplatesAsync(o.options.templatesFolder).done(function(){}).fail(function(t){console.log("Templates loading error"),e.reject()})),n.push(t.TemplateService.loadTemplateAsync(o.options.templatesBaseFolder,t.Constants.templateModalKey).done(function(e){var n=new t.Modal(e);o.modal=n,o.$el.append(n.$control)}).fail(function(t){console.log("Modal loading error"),e.reject()})),t.TemplateService.loadTemplateAsync(o.options.templatesBaseFolder,t.Constants.templateToolsKey).done(function(t){o.$tools=$(t);o.$toolsBtn=$("<button class='brickyeditor-tools-show-btn'><i class='fa fa-cog'></i></button>"),o.$toolsBtn.on("click",function(){o.modal.showModal(o.$tools.clone(!0))})}).fail(function(t){console.log("Tools loading error"),e.reject()}),t.TemplateService.loadTemplateAsync(o.options.templatesBaseFolder,t.Constants.templateHtmlToolsKey).done(function(e){var n=new t.HtmlTools(e,o);o.htmlTools=n,o.$el.append(n.$control)}).fail(function(t){console.log("Html Tools loading error"),e.reject()}),$.when.apply($,n).then(function(){o.addTools(),$(window).resize(function(){return o.checkIsCompactTools(o)}),e.resolve()}),e},o.prototype.addTools=function(){var e=this,o=new Array,n=$(t.Constants.selectorTemplates,e.$tools);n.hide(),e.$el.append(e.$tools),e.$el.append(e.$toolsBtn),e.checkIsCompactTools(e);for(var i in t.TemplateService.templates){var r=new t.Block(null,null,i),a=t.TemplateService.templates[i],l=$("<div class='template m-1 p-1' data-bricky-template=\""+i+'">'+r.getHtml(!0)+"</div>");n.append(l),t.Common.arrayEach(a.category,function(e){t.Common.arrayAny(o,function(t){return t.breEqualsInvariant(e)})||o.push(e)})}$(t.Constants.selectorTemplate,n).on("click",function(){var t=$(this).data().brickyTemplate;e.addBlock(t)}),$(t.Constants.selectorLoader,e.$tools).fadeOut("slow",function(){n.fadeIn("fast")});var c=$("[data-brickyeditor-hide-tools]",e.$tools);c.on("click",function(){c.attr("data-brickyeditor-hide-tools")?e.isMobile?(e.$tools.hide(),e.$toolsBtn.show()):(e.$tools.animate({right:"-204px"},"fast"),c.removeAttr("data-brickyeditor-hide-tools"),c.toggleClass("fa-arrow-left").toggleClass("fa-arrow-right")):e.isMobile||(e.$tools.animate({right:"0px"},"fast"),c.attr("data-brickyeditor-hide-tools","true"),c.toggleClass("fa-arrow-left").toggleClass("fa-arrow-right"))})},o.prototype.checkIsCompactTools=function(t){if(null==t.compactTools){var e=(window.innerWidth-t.$el.width())/2-t.$tools.width();t.isMobile=e<=0}else t.isMobile=t.compactTools},o}(t.Container);t.Editor=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function t(t){this.templatesBaseFolder="templates",this.templatesFolder="templates/bootstrap4",this.compactTools=null,this.templatesBaseFolder=t.templatesBaseFolder||this.templatesBaseFolder,this.templatesFolder=t.templatesFolder||this.templatesFolder,this.onload=t.onload,this.blocks=t.blocks,this.compactTools=t.compactTools}return t}();t.EditorOptions=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function t(){}return t.getEmbedAsync=function(t){var e=$.Deferred(),t="https://noembed.com/embed?url="+t;return $.ajax({url:t,type:"get",dataType:"jsonp"}).done(function(t){e.resolve(t)}).fail(function(t){e.reject(t)}),e},t}();t.EmbedService=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function e(e,o){var n=this;n.$control=$(e),$(t.Constants.selectorHtmlToolsCommand,this.$control).on("click",function(){var e=$(this),i=window.getSelection(),r=i.rangeCount>0?i.getRangeAt(0):null;if(!e.is(t.Constants.selectorHtmlToolsCommandRange)||r){var a=e.data().brickyeditorDocCommand;return"CreateLink"==a?o.modal.promptAsync(n.getLinkPromptParams(i)).done(function(t){i=window.getSelection(),i.addRange(r);var e=t.first(function(t){return"href"===t.key}).value;if(e){document.execCommand(a,!1,e);var o=t.first(function(t){return"target"===t.key}).value;o&&i.anchorNode.parentElement.setAttribute("target",o);var n=t.first(function(t){return"title"===t.key}).value;n&&i.anchorNode.parentElement.setAttribute("title",n)}}).fail(function(){i=window.getSelection(),i.addRange(r)}):document.execCommand(a),!1}})}return e.prototype.getLinkPromptParams=function(e){var o="",n="",i="";if(e.anchorNode&&e.anchorNode.parentNode.nodeName.breEqualsInvariant("a")){var r=$(e.anchorNode.parentNode);o=r.attr("href"),n=r.attr("title"),i=r.attr("target")}return[new t.Prompt.PromptParameter("href","Url",o,"Url"),new t.Prompt.PromptParameter("title","Title",n,"Title"),new t.Prompt.PromptParameterOptions("target","Target",[["",""],["Blank","_blank"],["Self","_self"],["Parent","_parent"],["Top","_top"]],i)]},e}();t.HtmlTools=e}(BrickyEditor||(BrickyEditor={})),function(t){t.fn.brickyeditor=function(e){return new BrickyEditor.Editor(t(this),e)}}(jQuery),function(t){t.fn.showLinkLocation=function(){return this.filter("a").append(function(){return" ("+this.href+")"}),this}}(jQuery);var BrickyEditor;!function(t){var e=function(){function e(e){var o=this;this.$control=$(e),this.$content=$(t.Constants.selectorModalContent,this.$control),$(t.Constants.selectorModalClose,this.$control).on("click",function(){o.hideModal()})}return e.prototype.hideModal=function(){var t=this.$content;this.$control.fadeOut(function(){t.html("")})},e.prototype.showModal=function(t){this.$content.append(t),t.is(":visible")||t.show(),this.$control.fadeIn()},e.prototype.promptAsync=function(t){var e=$.Deferred(),o=this,n=$("<form></form>");t.forEach(function(t){n.append(t.$control)});var i=$('<button type="button" class="btn btn-ok m-r-1">Ok</button>');i.on("click",function(){t.forEach(function(t){return t.parseValue()}),o.hideModal(),e.resolve(t)});var r=$('<button type="button" class="btn btn-cancel">Cancel</button>');return r.on("click",function(){o.hideModal(),e.reject(t)}),n.append(i),n.append(r),o.showModal(n),e},e}();t.Modal=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function t(){}return t.getSelectedText=function(){return window.getSelection().getRangeAt(0).toString()},t.replaceSelectedText=function(t){var e,o;window.getSelection&&(e=window.getSelection(),e.rangeCount&&(o=e.getRangeAt(0),o.deleteContents(),o.insertNode(document.createTextNode(t))))},t}();t.SelectionHelper=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function e(){}return e.loadTemplateAsync=function(t,o){var n=$.Deferred();return $.get(e.getTemplateUrl(t,o)).done(function(t){n.resolve(t)}).fail(function(t){n.reject(t)}),n},e.loadTemplateConfigAsync=function(t){var o=$.Deferred();return $.getJSON(e.getTemplatesConfigUrl(t)).done(function(t){o.resolve(t)}).fail(function(t){o.reject(t)}),o},e.filteredTemplates=function(o){return t.Common.arrayMap(e.templates,function(e){return t.Common.arrayAny(e.category,function(t){t.toLowerCase(),o.toLowerCase()})})},e.loadTemplatesAsync=function(t){var o,n=$.Deferred();return e.loadTemplateConfigAsync(t).done(function(t){o=t}).then(function(){var i=[];o.forEach(function(o){var n=e.loadTemplateAsync(t,o.file).done(function(t){o.html=t,e.templates[o.file]=o}).fail(function(t){console.log(t)});i.push(n)}),$.when.apply($,i).then(function(){n.resolve()})}),n},e.getTemplateUrl=function(t,e){return t+"/"+e+".html"},e.getTemplatesConfigUrl=function(t){return t+"/templates.json"},e.getTemplate=function(t){return e.templates[t]},e.removeTemplate=function(t){delete e.templates[t]},e.getFieldValue=function(t,e){return t.attr("data-bricky-field-"+e)},e}();e.templates={},t.TemplateService=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(){function e(e,o,n){this.block=e,this.$field=o,this.name=t.TemplateService.getFieldValue(o,"name"),this.type=t.TemplateService.getFieldValue(o,"type"),this.data=n||{},this.bind()}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),e.getField=function(e,o,n){var i=t.TemplateService.getFieldValue(o,"type"),r=this.fields[i];if(r)return r(e,o,n);throw i+" field not found"},e.prototype.bind=function(){},e.prototype.selectBlock=function(t){this.block.container.selectedBlock.selectBlock(this,t)},e.prototype.getData=function(){return{type:this.type,name:this.name,data:this.data}},e}();o.fields={html:function(t,o,n){return new e.HtmlField(t,o,n)},image:function(t,o,n){return new e.ImageField(t,o,n)},embed:function(t,o,n){return new e.EmbedField(t,o,n)},container:function(t,o,n){return new e.ContainerField(t,o,n)}},e.BaseField=o}(t.Fields||(t.Fields={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(e){function o(o,n,i){var r=e.call(this,o,n,i)||this;return r.container=new t.Container(n,r.block.editor),r}return __extends(o,e),Object.defineProperty(o.prototype,"data",{get:function(){return this.container?this.container.getData():{}},set:function(t){this._data=t},enumerable:!0,configurable:!0}),o.prototype.bind=function(){var t=this,e=this.$field;this.data;e.on("click",function(){t.selectBlock(t.container)})},o.prototype.select=function(){this.$field.addClass("selected")},o.prototype.deselect=function(){this.$field.removeClass("selected")},o}(e.BaseField);e.ContainerField=o}(t.Fields||(t.Fields={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.bind=function(){var e=this,o=this.$field;this.data;o.on("click",function(){var n=prompt("Link to embed","http://instagr.am/p/fA9uwTtkSN/");t.EmbedService.getEmbedAsync(n).done(function(t){e.data.url=n,e.data.embed=t;var i=$(t.html),r=i.filter("script");if(r.length>0){r.remove();var a=r.attr("src");a.breStartsWith("//")&&(a="http:"+a,$.getScript(a).done(function(t){a.breContains("instgram")&&instgrm&&instgrm.Embeds.process()}).fail(function(t){}))}o.replaceWith(i),e.selectBlock()})})},o}(e.BaseField);e.EmbedField=o}(t.Fields||(t.Fields={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.bind=function(){var e=this,o=this.$field,n=this.data;o.is("[contenteditable]")||o.attr("contenteditable","true"),this.data.html=this.data.html||t.TemplateService.getFieldValue(o,"html")||t.Constants.dummyText,o.html(this.data.html),o.on("focus",function(){e.selectBlock()}),o.on("blur keyup paste input",function(){n.html=$(this).html().trim()}),o.on("paste",function(t){var e=t.originalEvent,o=e.clipboardData.getData("text/html");if(o){var n=$("<div></div>"),i=$(o);i.removeAttr("style"),n.append(i),e.clipboardData.setData("text/html",n.html())}})},o}(e.BaseField);e.HtmlField=o}(t.Fields||(t.Fields={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.bind=function(){var e=this,o=this.$field;this.data;this.data.src||(this.data.src=t.TemplateService.getFieldValue(o,"src")),o.attr("src",this.data.src),o.on("click",function(){e.block.editor.modal.promptAsync(e.getPromptParams()).done(function(t){var o=t.first(function(t){return"file"===t.key}).value,n=t.first(function(t){return"src"===t.key}).value;o?(e.setFile(o),e.setSrc(null)):n&&(e.setSrc(n),e.setFile(null));var i=t.first(function(t){return"alt"===t.key}).value;e.setAlt(i)}),e.selectBlock()})},o.prototype.getPromptParams=function(){return[new t.Prompt.PromptParameter("src","Image Link",this.data.url,"image url"),new t.Prompt.PromptParameterImage("file","or Upload file",this.data.file,"select file"),new t.Prompt.PromptParameter("alt","Alt",this.data.alt,"alt attribute value ")]},o.prototype.setSrc=function(t){this.data.src=t,t&&this.$field.attr("src",this.data.src)},o.prototype.setAlt=function(t){this.data.alt=t,this.$field.attr("alt",this.data.alt)},o.prototype.setFile=function(t){this.data.file=t,t&&this.$field.attr("src",this.data.file.fileContent)},o}(e.BaseField);e.ImageField=o}(t.Fields||(t.Fields={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(){function t(t,e,o,n){this.key=t,this.title=e,this.placeholder=n||"",this.value=o}return t.prototype.parseValue=function(){this.value=this.$input.val(),this.$control=null,delete this._$control},Object.defineProperty(t.prototype,"$control",{get:function(){return this._$control||(this._$control=$('<div class="brickyeditor-prompt-field">\n                        <label for="'+this.key+'">'+(this.title?this.title:"")+"</label>\n                        </div>"),this.$input=this.getEditor(),this._$control.append(this.$input)),this._$control},set:function(t){this._$control=t},enumerable:!0,configurable:!0}),t.prototype.getEditor=function(){this.value;return $('<input type="text" id="'+this.key+'" class="brickyeditor-input" placeholder="'+this.placeholder+'" value="'+(this.value?this.value:"")+'">')},t}();t.PromptParameter=e}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(e){function o(t,o,n,i){var r=e.call(this,t,o,n,i)||this;return n&&(r._value=n),r}return __extends(o,e),o.prototype.parseValue=function(){this.value=this._value,this.$control=null,delete this._$control,this._value=null,delete this._value},o.prototype.getEditor=function(){var e=this,o=this.value&&this.value.fileContent?this.value.fileContent:"",n=$("\n                <div class='brickyeditor-image-input'>\n                    <label for=\""+this.key+'">\n                        <img src="'+o+'"/>\n                    </label>                        \n                    <input type="file" id="'+this.key+'" class="brickyeditor-input" placeholder="'+this.placeholder+"\">\n                </div>\n                <small class='brickyeditor-image-input-filename'></small>"),i=$("input",n),r=$("img",n),a=$(".brickyeditor-image-input-filename",n),l=this.value;return l&&(r.attr("src",l.fileContent),a.text(l.fileInfo.name)),i.change(function(){var o=this;if(o.files&&o.files[0]){var n=new FileReader;n.onload=function(n){var i=n.target;e._value=new t.PromptParameterImageResult,e._value.fileContent=i.result,e._value.fileInfo=new t.PromptParameterImageResultFile(o.files[0]),r.attr("src",e._value.fileContent),a.text(e._value.fileInfo.name)},n.readAsDataURL(o.files[0])}}),n},o}(t.PromptParameter);t.PromptParameterImage=e}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(){function t(){}return t}();t.PromptParameterImageResult=e;var o=function(){function t(t){this.name=t.name,this.size=t.size,this.type=t.type,this.lastModified=t.lastModified,this.lastModifiedDate=t.lastModifiedDate}return t}();t.PromptParameterImageResultFile=o}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(){function t(t,e,o){void 0===o&&(o=!1),this.title=t,this.value=e,this.selected=o}return t}();t.PromptParameterOption=e}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(o){function n(t,n,i,r,a){var l=o.call(this,t,n,r,a)||this;return l.options=[],i.forEach(function(t){l.options.push(new e.PromptParameterOption(t[0],t[1],t[1]==r))}),l}return __extends(n,o),n.prototype.getEditor=function(){var e=t.Common.arrayMap(this.options,function(t){return'<option value="'+t.value+'" '+(t.selected?"selected":"")+">"+(t.title?t.title:t.value)+"</option>"});return $('<select type="text" id="'+this.key+'" class="brickyeditor-input" placeholder="'+this.placeholder+'">'+e+"</select>")},n}(e.PromptParameter);e.PromptParameterOptions=o}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));